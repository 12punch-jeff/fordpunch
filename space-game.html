<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Space Explorer - Ford's World</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        .game-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
        }

        #gameCanvas {
            border: 3px solid var(--accent-orange);
            border-radius: 12px;
            box-shadow: 0 0 30px rgba(255, 153, 0, 0.4);
            max-width: 100%;
            touch-action: none;
        }

        .game-stats {
            display: flex;
            gap: 2rem;
            font-family: 'Orbitron', monospace;
            font-size: 1.5rem;
        }

        .stat {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .stat-icon {
            font-size: 1.8rem;
        }

        .stat-value {
            color: var(--accent-orange);
            min-width: 60px;
        }

        .game-controls {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .game-btn {
            font-family: 'Orbitron', monospace;
            font-size: 1.2rem;
            padding: 1rem 2rem;
            background: linear-gradient(135deg, var(--accent-orange), var(--accent-magenta));
            border: none;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .game-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(255, 153, 0, 0.6);
        }

        .game-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .instructions {
            text-align: center;
            max-width: 500px;
            margin: 1rem auto;
            font-size: 1.1rem;
            line-height: 1.6;
        }

        .instructions h3 {
            color: var(--accent-orange);
            margin-bottom: 0.5rem;
        }

        .mobile-controls {
            display: none;
            gap: 1rem;
            margin-top: 1rem;
        }

        .mobile-btn {
            width: 80px;
            height: 80px;
            font-size: 2.5rem;
            background: rgba(255, 153, 0, 0.3);
            border: 2px solid var(--accent-orange);
            border-radius: 50%;
            color: white;
            cursor: pointer;
            user-select: none;
            -webkit-user-select: none;
        }

        .mobile-btn:active {
            background: rgba(255, 153, 0, 0.6);
            transform: scale(0.95);
        }

        @media (max-width: 768px) {
            .mobile-controls {
                display: flex;
            }
            
            .game-stats {
                font-size: 1.2rem;
                gap: 1rem;
            }

            #gameCanvas {
                max-height: 50vh;
            }
        }

        .game-over-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .game-over-content {
            text-align: center;
            animation: popIn 0.5s ease-out;
        }

        @keyframes popIn {
            0% { transform: scale(0.5); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        .game-over-content h2 {
            font-family: 'Orbitron', monospace;
            font-size: 3rem;
            color: var(--accent-orange);
            margin-bottom: 1rem;
            text-shadow: 0 0 20px var(--accent-orange);
        }

        .final-score {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .high-score {
            font-size: 1.5rem;
            color: var(--accent-magenta);
            margin-bottom: 2rem;
        }

        .new-record {
            color: gold;
            animation: pulse 0.5s ease-in-out infinite alternate;
        }

        @keyframes pulse {
            from { text-shadow: 0 0 10px gold; }
            to { text-shadow: 0 0 30px gold; }
        }
    </style>
</head>
<body>
    <nav class="nav">
        <a href="index.html" class="nav-brand">üöÄ Ford's World</a>
        <div class="nav-links">
            <a href="index.html">Home</a>
            <a href="games.html">Games</a>
            <a href="party.html">Party</a>
        </div>
    </nav>

    <main class="container">
        <h1 class="page-title">üõ∏ Space Explorer üõ∏</h1>
        
        <div class="game-wrapper">
            <div class="game-stats">
                <div class="stat">
                    <span class="stat-icon">‚≠ê</span>
                    <span class="stat-value" id="score">0</span>
                </div>
                <div class="stat">
                    <span class="stat-icon">‚ù§Ô∏è</span>
                    <span class="stat-value" id="lives">3</span>
                </div>
                <div class="stat">
                    <span class="stat-icon">üèÜ</span>
                    <span class="stat-value" id="highScore">0</span>
                </div>
            </div>

            <canvas id="gameCanvas" width="600" height="700"></canvas>

            <div class="game-controls">
                <button class="game-btn" id="startBtn">üöÄ START</button>
                <button class="game-btn" id="pauseBtn" disabled>‚è∏Ô∏è PAUSE</button>
            </div>

            <div class="mobile-controls">
                <button class="mobile-btn" id="leftBtn">‚¨ÖÔ∏è</button>
                <button class="mobile-btn" id="rightBtn">‚û°Ô∏è</button>
            </div>

            <div class="instructions card">
                <h3>How to Play</h3>
                <p>
                    üéÆ Use <strong>‚Üê ‚Üí</strong> arrow keys to move your ship<br>
                    ‚≠ê Collect stars to score points<br>
                    ‚òÑÔ∏è Dodge the asteroids!<br>
                    ‚ù§Ô∏è You have 3 lives - be careful!<br>
                    üèÜ Beat your high score!
                </p>
            </div>
        </div>
    </main>

    <div class="game-over-overlay" id="gameOverOverlay">
        <div class="game-over-content">
            <h2>GAME OVER</h2>
            <p class="final-score">Stars Collected: <span id="finalScore">0</span> ‚≠ê</p>
            <p class="high-score" id="highScoreMsg">High Score: 0</p>
            <button class="game-btn" id="playAgainBtn">üöÄ PLAY AGAIN</button>
        </div>
    </div>

    <script src="js/sparkles.js"></script>
    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        // Game state
        let gameRunning = false;
        let gamePaused = false;
        let score = 0;
        let lives = 3;
        let highScore = localStorage.getItem('spaceGameHighScore') || 0;
        let animationId;
        let difficulty = 1;

        // Display elements
        const scoreEl = document.getElementById('score');
        const livesEl = document.getElementById('lives');
        const highScoreEl = document.getElementById('highScore');
        const startBtn = document.getElementById('startBtn');
        const pauseBtn = document.getElementById('pauseBtn');
        const gameOverOverlay = document.getElementById('gameOverOverlay');
        const finalScoreEl = document.getElementById('finalScore');
        const highScoreMsgEl = document.getElementById('highScoreMsg');
        const playAgainBtn = document.getElementById('playAgainBtn');

        highScoreEl.textContent = highScore;

        // Ship
        const ship = {
            x: canvas.width / 2,
            y: canvas.height - 80,
            width: 50,
            height: 60,
            speed: 8,
            moveLeft: false,
            moveRight: false
        };

        // Game objects
        let stars = [];
        let asteroids = [];
        let particles = [];

        // Colors
        const colors = {
            ship: '#00ffff',
            shipGlow: '#0088ff',
            star: '#ffdd00',
            asteroid: '#8b4513',
            particle: ['#ff6600', '#ffaa00', '#ff0066', '#00ffff']
        };

        // Draw ship (Ford's rocket)
        function drawShip() {
            ctx.save();
            ctx.translate(ship.x, ship.y);
            
            // Ship glow
            ctx.shadowColor = colors.shipGlow;
            ctx.shadowBlur = 20;
            
            // Main body
            ctx.fillStyle = colors.ship;
            ctx.beginPath();
            ctx.moveTo(0, -ship.height/2);
            ctx.lineTo(-ship.width/2, ship.height/2);
            ctx.lineTo(-ship.width/4, ship.height/3);
            ctx.lineTo(0, ship.height/2);
            ctx.lineTo(ship.width/4, ship.height/3);
            ctx.lineTo(ship.width/2, ship.height/2);
            ctx.closePath();
            ctx.fill();
            
            // Cockpit
            ctx.fillStyle = '#ff9900';
            ctx.beginPath();
            ctx.ellipse(0, 0, 10, 15, 0, 0, Math.PI * 2);
            ctx.fill();
            
            // Engine flames
            if (gameRunning && !gamePaused) {
                ctx.shadowColor = '#ff6600';
                ctx.fillStyle = `hsl(${30 + Math.random() * 30}, 100%, 50%)`;
                ctx.beginPath();
                ctx.moveTo(-10, ship.height/2);
                ctx.lineTo(0, ship.height/2 + 15 + Math.random() * 10);
                ctx.lineTo(10, ship.height/2);
                ctx.fill();
            }
            
            ctx.restore();
        }

        // Create star
        function createStar() {
            return {
                x: Math.random() * (canvas.width - 40) + 20,
                y: -30,
                size: 20 + Math.random() * 10,
                speed: 2 + Math.random() * 2 + difficulty * 0.3,
                rotation: 0,
                rotationSpeed: 0.05 + Math.random() * 0.05
            };
        }

        // Create asteroid
        function createAsteroid() {
            const size = 30 + Math.random() * 30;
            return {
                x: Math.random() * (canvas.width - size * 2) + size,
                y: -size,
                size: size,
                speed: 1.5 + Math.random() * 2 + difficulty * 0.5,
                rotation: 0,
                rotationSpeed: 0.02 + Math.random() * 0.04,
                vertices: generateAsteroidVertices()
            };
        }

        // Generate asteroid shape
        function generateAsteroidVertices() {
            const vertices = [];
            const points = 8 + Math.floor(Math.random() * 4);
            for (let i = 0; i < points; i++) {
                const angle = (i / points) * Math.PI * 2;
                const radius = 0.7 + Math.random() * 0.3;
                vertices.push({ angle, radius });
            }
            return vertices;
        }

        // Draw star
        function drawStar(star) {
            ctx.save();
            ctx.translate(star.x, star.y);
            ctx.rotate(star.rotation);
            
            ctx.shadowColor = colors.star;
            ctx.shadowBlur = 15;
            ctx.fillStyle = colors.star;
            
            // 5-pointed star
            ctx.beginPath();
            for (let i = 0; i < 5; i++) {
                const angle = (i * 4 * Math.PI / 5) - Math.PI / 2;
                const x = Math.cos(angle) * star.size;
                const y = Math.sin(angle) * star.size;
                if (i === 0) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            }
            ctx.closePath();
            ctx.fill();
            
            ctx.restore();
        }

        // Draw asteroid
        function drawAsteroid(asteroid) {
            ctx.save();
            ctx.translate(asteroid.x, asteroid.y);
            ctx.rotate(asteroid.rotation);
            
            ctx.shadowColor = '#ff4400';
            ctx.shadowBlur = 10;
            
            // Gradient for 3D effect
            const gradient = ctx.createRadialGradient(
                -asteroid.size * 0.3, -asteroid.size * 0.3, 0,
                0, 0, asteroid.size
            );
            gradient.addColorStop(0, '#a06030');
            gradient.addColorStop(1, '#4a2810');
            ctx.fillStyle = gradient;
            
            ctx.beginPath();
            asteroid.vertices.forEach((v, i) => {
                const x = Math.cos(v.angle) * asteroid.size * v.radius;
                const y = Math.sin(v.angle) * asteroid.size * v.radius;
                if (i === 0) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            });
            ctx.closePath();
            ctx.fill();
            
            ctx.restore();
        }

        // Create particle explosion
        function createParticles(x, y, color, count) {
            for (let i = 0; i < count; i++) {
                particles.push({
                    x, y,
                    vx: (Math.random() - 0.5) * 10,
                    vy: (Math.random() - 0.5) * 10,
                    size: 3 + Math.random() * 5,
                    color: color || colors.particle[Math.floor(Math.random() * colors.particle.length)],
                    life: 1
                });
            }
        }

        // Draw and update particles
        function updateParticles() {
            particles = particles.filter(p => {
                p.x += p.vx;
                p.y += p.vy;
                p.life -= 0.03;
                p.size *= 0.95;
                
                if (p.life > 0) {
                    ctx.save();
                    ctx.globalAlpha = p.life;
                    ctx.fillStyle = p.color;
                    ctx.shadowColor = p.color;
                    ctx.shadowBlur = 10;
                    ctx.beginPath();
                    ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.restore();
                    return true;
                }
                return false;
            });
        }

        // Check collision
        function checkCollision(obj1, obj2, r1, r2) {
            const dx = obj1.x - obj2.x;
            const dy = obj1.y - obj2.y;
            const distance = Math.sqrt(dx * dx + dy * dy);
            return distance < r1 + r2;
        }

        // Update game
        function update() {
            // Move ship
            if (ship.moveLeft && ship.x > ship.width/2 + 10) {
                ship.x -= ship.speed;
            }
            if (ship.moveRight && ship.x < canvas.width - ship.width/2 - 10) {
                ship.x += ship.speed;
            }

            // Update stars
            stars.forEach((star, i) => {
                star.y += star.speed;
                star.rotation += star.rotationSpeed;
                
                // Collect star
                if (checkCollision(ship, star, ship.width/2, star.size)) {
                    score += 10;
                    scoreEl.textContent = score;
                    createParticles(star.x, star.y, colors.star, 15);
                    stars.splice(i, 1);
                    
                    // Increase difficulty
                    if (score % 100 === 0) {
                        difficulty += 0.2;
                    }
                }
                
                // Remove off-screen stars
                if (star.y > canvas.height + 30) {
                    stars.splice(i, 1);
                }
            });

            // Update asteroids
            asteroids.forEach((asteroid, i) => {
                asteroid.y += asteroid.speed;
                asteroid.rotation += asteroid.rotationSpeed;
                
                // Hit asteroid
                if (checkCollision(ship, asteroid, ship.width/2 - 10, asteroid.size * 0.7)) {
                    lives--;
                    livesEl.textContent = lives;
                    createParticles(asteroid.x, asteroid.y, '#ff4400', 20);
                    asteroids.splice(i, 1);
                    
                    if (lives <= 0) {
                        gameOver();
                    }
                }
                
                // Remove off-screen asteroids
                if (asteroid.y > canvas.height + asteroid.size) {
                    asteroids.splice(i, 1);
                }
            });

            // Spawn new objects
            if (Math.random() < 0.03 + difficulty * 0.005) {
                stars.push(createStar());
            }
            if (Math.random() < 0.015 + difficulty * 0.003) {
                asteroids.push(createAsteroid());
            }
        }

        // Draw background stars
        function drawBackground() {
            ctx.fillStyle = '#0a0a1a';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Twinkling stars
            for (let i = 0; i < 50; i++) {
                const x = (i * 73 + Date.now() * 0.01) % canvas.width;
                const y = (i * 137) % canvas.height;
                const size = 1 + Math.sin(Date.now() * 0.003 + i) * 0.5;
                ctx.fillStyle = `rgba(255, 255, 255, ${0.3 + Math.sin(Date.now() * 0.005 + i) * 0.3})`;
                ctx.beginPath();
                ctx.arc(x, y, size, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        // Game loop
        function gameLoop() {
            if (!gameRunning || gamePaused) return;
            
            drawBackground();
            update();
            
            stars.forEach(drawStar);
            asteroids.forEach(drawAsteroid);
            updateParticles();
            drawShip();
            
            animationId = requestAnimationFrame(gameLoop);
        }

        // Start game
        function startGame() {
            gameRunning = true;
            gamePaused = false;
            score = 0;
            lives = 3;
            difficulty = 1;
            stars = [];
            asteroids = [];
            particles = [];
            ship.x = canvas.width / 2;
            
            scoreEl.textContent = score;
            livesEl.textContent = lives;
            startBtn.disabled = true;
            pauseBtn.disabled = false;
            startBtn.textContent = 'üéÆ PLAYING';
            gameOverOverlay.style.display = 'none';
            
            gameLoop();
        }

        // Pause game
        function togglePause() {
            gamePaused = !gamePaused;
            pauseBtn.textContent = gamePaused ? '‚ñ∂Ô∏è RESUME' : '‚è∏Ô∏è PAUSE';
            if (!gamePaused) gameLoop();
        }

        // Game over
        function gameOver() {
            gameRunning = false;
            cancelAnimationFrame(animationId);
            
            startBtn.disabled = false;
            pauseBtn.disabled = true;
            startBtn.textContent = 'üöÄ START';
            
            // Check high score
            const isNewRecord = score > highScore;
            if (isNewRecord) {
                highScore = score;
                localStorage.setItem('spaceGameHighScore', highScore);
                highScoreEl.textContent = highScore;
            }
            
            // Show game over screen
            finalScoreEl.textContent = score;
            highScoreMsgEl.textContent = isNewRecord ? 'üéâ NEW HIGH SCORE! üéâ' : `High Score: ${highScore}`;
            highScoreMsgEl.className = isNewRecord ? 'high-score new-record' : 'high-score';
            gameOverOverlay.style.display = 'flex';
        }

        // Controls
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft' || e.key === 'a') ship.moveLeft = true;
            if (e.key === 'ArrowRight' || e.key === 'd') ship.moveRight = true;
            if (e.key === ' ' && !gameRunning) startGame();
            if (e.key === 'p' && gameRunning) togglePause();
        });

        document.addEventListener('keyup', (e) => {
            if (e.key === 'ArrowLeft' || e.key === 'a') ship.moveLeft = false;
            if (e.key === 'ArrowRight' || e.key === 'd') ship.moveRight = false;
        });

        // Mobile controls
        const leftBtn = document.getElementById('leftBtn');
        const rightBtn = document.getElementById('rightBtn');

        leftBtn.addEventListener('touchstart', (e) => { e.preventDefault(); ship.moveLeft = true; });
        leftBtn.addEventListener('touchend', () => ship.moveLeft = false);
        rightBtn.addEventListener('touchstart', (e) => { e.preventDefault(); ship.moveRight = true; });
        rightBtn.addEventListener('touchend', () => ship.moveRight = false);

        // Button events
        startBtn.addEventListener('click', startGame);
        pauseBtn.addEventListener('click', togglePause);
        playAgainBtn.addEventListener('click', startGame);

        // Initial draw
        drawBackground();
        drawShip();
    </script>
</body>
</html>
